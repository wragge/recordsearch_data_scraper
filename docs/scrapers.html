---

title: Scrapers


keywords: fastai
sidebar: home_sidebar

summary: "A set of classes for scraping data about items, series, and agencies from the National Archives of Australia's online database, RecordSearch."
description: "A set of classes for scraping data about items, series, and agencies from the National Archives of Australia's online database, RecordSearch."
nb_path: "00_scrapers.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_scrapers.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The main entities described within RecordSearch are <strong>Items</strong>, <strong>Series</strong>, and <strong>Agencies</strong>. Put simply, items are contained within series, and series are created and controlled by agencies. But the <a href="https://www.naa.gov.au/help-your-research/getting-started/commonwealth-record-series-crs-system">Series System</a>, on which RecordSearch is based, allows a much more complex range of relationships between entities to be documented.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_session" class="doc_header"><code>make_session</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_session</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_browser" class="doc_header"><code>make_browser</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_browser</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSBase" class="doc_header"><code>class</code> <code>RSBase</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L315" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSBase</code>()</p>
</blockquote>
<p>Base class with utility methods.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSEntity" class="doc_header"><code>class</code> <code>RSEntity</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L368" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSEntity</code>(<strong><code>identifier</code></strong>=<em><code>None</code></em>, <strong><code>cache</code></strong>=<em><code>True</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/recordsearch_data_scraper/scrapers.html#RSBase"><code>RSBase</code></a></p>
</blockquote>
<p>Base class for individual RecordSearch entities – item, series, or agency.</p>
<p>Not for direct use – use the appropriate subclass instead.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSSearch" class="doc_header"><code>class</code> <code>RSSearch</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L481" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSSearch</code>(<strong><code>results_per_page</code></strong>=<em><code>20</code></em>, <strong><code>sort</code></strong>=<em><code>None</code></em>, <strong><code>record_detail</code></strong>=<em><code>'brief'</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/recordsearch_data_scraper/scrapers.html#RSBase"><code>RSBase</code></a></p>
</blockquote>
<p>Base class for an advanced search in RecordSearch. There are different search forms for the different
RecordSearch entities, so don't use this directly. Use one of the subclasses.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSItem" class="doc_header"><code>class</code> <code>RSItem</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L645" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSItem</code>(<strong><code>identifier</code></strong>=<em><code>None</code></em>, <strong><code>cache</code></strong>=<em><code>True</code></em>, <strong><code>details</code></strong>=<em><code>None</code></em>) :: <a href="/recordsearch_data_scraper/scrapers.html#RSEntity"><code>RSEntity</code></a></p>
</blockquote>
<p>Class used for extracting data about an individual item (usually a file, but can be a volume, box, photograph etc) from RecordSearch.</p>
<p>You need to supply one of the following parameters:</p>
<ul>
<li><code>identifier</code> – the Item ID (aka barcode)</li>
<li><code>details</code> – the BeautifulSoup HTML element containing the item details</li>
</ul>
<p>You'd only use <code>details</code> if you already have a RecordSearch page and want to extract item data from it.
(There's an example of this in the <a href="/recordsearch_data_scraper/scrapers.html#RSItemSearch"><code>RSItemSearch</code></a> class.)</p>
<p>The item data is obtained by accessing the item's <code>.data</code> attribute.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Items in RecordSearch are usually paper files, but can be other things like volumes, boxes, videos, or digital objects. Items have a unique identifier described as the 'Item ID', this was previously referred to as the item's 'barcode'. The <a href="/recordsearch_data_scraper/scrapers.html#RSItem"><code>RSItem</code></a> class extracts information about an individual item from RecordSearch, using it's Item ID.</p>
<p>Here are the fields returned:</p>
<ul>
<li><code>title</code> (string)</li>
<li><code>identifier</code> (string)</li>
<li><code>series</code> (string)</li>
<li><code>control_symbol</code> (string)</li>
<li><code>digitised_status</code> (boolean) – <code>True</code> if the item has been digitised</li>
<li><code>digitised_pages</code> (integer) – number of pages in the digitised file</li>
<li><code>access_status</code> (string) – one of 'Open', 'OWE', 'Closed', 'NYE' (see <a href="#Access-status-options">access status options</a>)</li>
<li><code>access_decision_reasons</code> (list) – a list of reasons why material has been been witheld from public access (if CLOSED, or OWE)</li>
<li><code>location</code> (string)</li>
<li><code>contents_date_str</code> (ISO formatted date)</li>
<li><code>contents_start_date</code> (ISO formatted date)</li>
<li><code>contents_end_date</code> (ISO formatted date)</li>
<li><code>access_decision_date_str</code> (ISO formatted date)</li>
<li><code>access_decision_date</code> (ISO formatted date)</li>
<li><code>retrieved</code> (ISO formatted datetime) - when this record was scraped</li>
</ul>
<p>Note that <code>digitised_pages</code> is not part of the metadata presented in RecordSearch's item description. This value is obtained from the digitised file viewer using <code>get_digitised_pages()</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To retrieve information about an item, just give <code>RSItem()</code> the Item ID (also known as the barcode).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item</span> <span class="o">=</span> <span class="n">RSItem</span><span class="p">(</span><span class="s1">&#39;3445411&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can then access the item data using the <code>.data</code> attribute.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use <code>item.data[FIELD NAME]</code> to access individual fields. The <code>series</code> value of this item should be 'B2455'.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">item</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;series&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;B2455&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As an added bonus, the string representation of the item is also its brief citation.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The extracted data is saved into a simple key-value cache to speed up repeat requests. If you want to scrape a fresh version, use <code>.refresh_cache()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSEntity.refresh_cache" class="doc_header"><code>RSEntity.refresh_cache</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L385" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSEntity.refresh_cache</code>()</p>
</blockquote>
<p>Delete data for this entity from the cache, then extract a fresh version from RecordSearch.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check that this has worked by comparing the value of <code>retrieved</code>, which is the date/time the data was scraped.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">old_retrieved_date</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;retrieved&#39;</span><span class="p">]</span>

<span class="n">item</span><span class="o">.</span><span class="n">refresh_cache</span><span class="p">()</span>

<span class="n">new_retrieved_date</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;retrieved&#39;</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">old_retrieved_date</span> <span class="o">!=</span> <span class="n">new_retrieved_date</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSItemSearch" class="doc_header"><code>class</code> <code>RSItemSearch</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L749" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSItemSearch</code>(<strong><code>results_per_page</code></strong>=<em><code>20</code></em>, <strong><code>sort</code></strong>=<em><code>9</code></em>, <strong><code>record_detail</code></strong>=<em><code>'brief'</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/recordsearch_data_scraper/scrapers.html#RSSearch"><code>RSSearch</code></a></p>
</blockquote>
<p>Search for items in RecordSearch.</p>
<p>Supply any of the item search parameters as kwargs to initialise the search.</p>
<p>Optional parameters:</p>
<ul>
<li><code>results_per_page</code> (default: 20)</li>
<li><code>sort</code> (default: 1 – order by id)</li>
<li><code>page</code> – to retrieve a specific page of results</li>
<li><code>record_detail</code> – amount of detail to include, options are:<ul>
<li>'brief' (default) – just the info in the search results</li>
<li><code>digitised</code> – add the number of pages if the file is digitised (slower)</li>
<li>'full' – get the full individual record for each result (slowest)</li>
</ul>
</li>
</ul>
<p>To access a page of results, use the <code>.get_results()</code> method.
This method increments the results page, so you can call it in a loop
to retrieve the complete result set.</p>
<p>Useful attributes:</p>
<ul>
<li><code>.total_results</code> – the total number of results in the results set</li>
<li><code>.total_pages</code> – the total number of result pages</li>
<li><code>.kwargs</code> – a dict containing the supplied search parameters</li>
<li><code>.params</code> – a dict containing the values of the optional parameters</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Item-search-parameters">Item search parameters<a class="anchor-link" href="#Item-search-parameters"> </a></h3><p>These are the parameters you can supply as keyword arguments to <a href="/recordsearch_data_scraper/scrapers.html#RSItemSearch"><code>RSItemSearch</code></a>.</p>
<table>
<thead><tr>
<th style="text-align:left">Parameter</th>
<th style="text-align:left">Input type</th>
<th style="text-align:left">Values</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>kw</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Keywords or phrase to search for</td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_options</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">How to combine the keywords – see <a href="#Keyword-options">keyword options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_exclude</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Keywords or phrase to exclude</td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_exclude_options</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">How to combine the keywords – see <a href="#Keyword-options">keyword options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>search_notes</strong></td>
<td style="text-align:left">Checkbox</td>
<td style="text-align:left">Set to <code>True</code> to search notes as well as titles</td>
</tr>
<tr>
<td style="text-align:left"><strong>series</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Limit to items from this series – eg 'A1'</td>
</tr>
<tr>
<td style="text-align:left"><strong>series_exclude</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Exclude items from this series</td>
</tr>
<tr>
<td style="text-align:left"><strong>control</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Limit to items with this control symbol (use <em> for wildcards) – eg '1947/2</em>'</td>
</tr>
<tr>
<td style="text-align:left"><strong>control_exclude</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Exclude items with this control symbol</td>
</tr>
<tr>
<td style="text-align:left"><strong>item_id</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Get the item with this identifier (no wildcards allowed)</td>
</tr>
<tr>
<td style="text-align:left"><strong>date_from</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Include items with content after this date (year only) – eg '1925'</td>
</tr>
<tr>
<td style="text-align:left"><strong>date_to</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Include items with content before this date (year only) – eg '1945'</td>
</tr>
<tr>
<td style="text-align:left"><strong>formats</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to items in this format – see <a href="#Format-options">format options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>formats_exclude</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Exclude items in this format  – see <a href="#Format-options">format options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>locations</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to items held in this location – see list of <a href="#Location-options">locations</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>locations_exclude</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Exclude items held in this location – see list of <a href="#Location-options">locations</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>access</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to items with this access status – see <a href="#Access-status-options">access status options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>access_exclude</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Exclude items with this access status – see <a href="#Access-status-options">access status options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>digital</strong></td>
<td style="text-align:left">Checkbox</td>
<td style="text-align:left">Limit to digitised items – set to <code>True</code></td>
</tr>
</tbody>
</table>
<h3 id="Keyword-options">Keyword options<a class="anchor-link" href="#Keyword-options"> </a></h3><p>Use one of the following values to specify how keywords or phrases should be treated using the <code>kw_options</code> parameter. The default is 'ALL'.</p>
<ul>
<li><strong>'ALL'</strong> (default) – must include all keywords</li>
<li><strong>'ANY'</strong> – must include at least one of the keywords</li>
<li><strong>'EXACT'</strong> – treat the keywords as a phrase</li>
</ul>
<h3 id="Format-options">Format options<a class="anchor-link" href="#Format-options"> </a></h3><p>Use one of the following values with the <code>formats</code> and <code>formats_exclude</code> parameters to limit your results to items in that format. The default is to include all formats.</p>
<ul>
<li><strong>'Paper files and documents'</strong></li>
<li><strong>'Index cards'</strong></li>
<li><strong>'Bound volumes'</strong></li>
<li><strong>'Cartographic records'</strong></li>
<li><strong>'Photographs'</strong></li>
<li><strong>'Microforms'</strong></li>
<li><strong>'Audio-visual records'</strong></li>
<li><strong>'Audio records'</strong></li>
<li><strong>'Electronic records'</strong></li>
<li><strong>'3-dimensional records'</strong></li>
<li><strong>'Scientific specimens'</strong></li>
<li><strong>'Textiles'</strong></li>
</ul>
<h3 id="Location-options">Location options<a class="anchor-link" href="#Location-options"> </a></h3><p>Use one of the following values with the <code>locations</code> and <code>locations_exclude</code> parameters to limit your results to items held in that location. The default is to include all locations.</p>
<ul>
<li><strong>'NAT,ACT'</strong> – National office (ACT)</li>
<li><strong>'AWM'</strong> – Australian War Memorial</li>
<li><strong>'NSW'</strong></li>
<li><strong>'NT'</strong></li>
<li><strong>'QLD'</strong></li>
<li><strong>'SA'</strong></li>
<li><strong>'TAS'</strong></li>
<li><strong>'VIC'</strong></li>
<li><strong>'WA'</strong></li>
</ul>
<h3 id="Access-status-options">Access status options<a class="anchor-link" href="#Access-status-options"> </a></h3><p>Use one of the following values with the <code>access</code> and <code>access_exclude</code> parameters to limit your results to items with this access examination status. The default is to include all.</p>
<ul>
<li><strong>'OPEN'</strong> – available for public access</li>
<li><strong>'OWE'</strong> – open with exceptions (eg it might have pages withheld or redactions applied)</li>
<li><strong>'CLOSED'</strong> – withheld completely from public access</li>
<li><strong>'NYE'</strong> – not yet examined (no access decision has been made)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a basic keyword search for items.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_results</span> <span class="o">=</span> <span class="n">RSItemSearch</span><span class="p">(</span><span class="n">kw</span><span class="o">=</span><span class="s1">&#39;wragge&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialising the <a href="/recordsearch_data_scraper/scrapers.html#RSItemSearch"><code>RSItemSearch</code></a> class sets up the search and retrieves some information about the results set. For example, to see the total number of results, we just access the <code>.total_results</code> attribute.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_results</span><span class="o">.</span><span class="n">total_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSSearch.get_results" class="doc_header"><code>RSSearch.get_results</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L504" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSSearch.get_results</code>(<strong><code>page</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Return a list of results from a search results page.</p>
<p>The <code>page</code> value is incremented with each request, so you can call this method
in a loop to retrieve the complete results set. When you reach then of the results,
this method will return an empty list.</p>
<p>Optional parameter:</p>
<ul>
<li><code>page</code> – request a specific page from the results set</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_results</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_results</span><span class="o">.</span><span class="n">params</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calling <code>.refresh_cache</code> will remove all of the data for this search from the cache, and set the results page back to 1.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSSearch.refresh_cache" class="doc_header"><code>RSSearch.refresh_cache</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L553" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSSearch.refresh_cache</code>()</p>
</blockquote>
<p>Delete data for this search from the cache, then retrieve a fresh version from RecordSearch.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSSeries" class="doc_header"><code>class</code> <code>RSSeries</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L842" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSSeries</code>(<strong><code>identifier</code></strong>=<em><code>None</code></em>, <strong><code>cache</code></strong>=<em><code>True</code></em>, <strong><code>details</code></strong>=<em><code>None</code></em>, <strong><code>include_number_digitised</code></strong>=<em><code>True</code></em>, <strong><code>include_access_status</code></strong>=<em><code>True</code></em>) :: <a href="/recordsearch_data_scraper/scrapers.html#RSEntity"><code>RSEntity</code></a></p>
</blockquote>
<p>Class used for extracting data about an individual series.
You need to supply the following parameter:</p>
<ul>
<li><code>identifier</code> – the series number, eg 'A1', 'B2455'</li>
</ul>
<p>Optional parameters:</p>
<ul>
<li><code>include_number_digitised</code> (boolean, default: True) –
include the number of items in this series that have been digitised.</li>
<li><code>include_access_status</code> (boolean, default: True) –
include the number of items in this series in each of the access status categories.</li>
</ul>
<p>The series data is obtained by accessing the series' <code>.data</code> attribute.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A series is a group of records that have something in common, for example, they might have been part of the same filing system. Series can be related to other series, and to agencies. A single series can also be held across multiple locations. All this means the data can be quite complex.</p>
<p>Not that as well as the standard RecordSearch metadata, the scraper can also extract some extra information about the series, such as the number of items digitised, and the access status of items in the series.</p>
<p>Here are the fields returned:</p>
<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>physical_format</code> (string)</li>
<li><code>arrangement</code> (string)</li>
<li><code>control_symbols</code> (string)</li>
<li><code>locations</code> (list) – a list of locations, each with the fields:<ul>
<li><code>quantity</code> (string)</li>
<li><code>location</code> (string)</li>
</ul>
</li>
<li><code>recording_agencies</code> – a list of agencies, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>controlling_agencies</code> – a list of agencies, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>previous_series</code> – a list of series, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>subsequent_series</code> – a list of series, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>controlling_series</code> – a list of series, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>related_series</code> (list) – a list of series, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>items_described</code> (integer)</li>
<li><code>items_described_note</code> (string)</li>
<li><code>contents_date_str</code> (string)</li>
<li><code>contents_start_date</code> (ISO formatted date)</li>
<li><code>contents_end_date</code> (ISO formatted date)</li>
<li><code>accumulation_date_str</code> (string)</li>
<li><code>accumulation_start_date</code> (ISO formatted date)</li>
<li><code>accumulation_end_date</code> (ISO formatted date)</li>
<li><code>items_digitised</code> (integer) – the number of items in this series that have been digitised</li>
<li><code>access_status_totals</code> (dict) – the number of items in each of the access status categories, OPEN, OWE, CLOSED, and NYE.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To retrieve information about a series, just give <code>RSSeries()</code> the series number.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">series</span> <span class="o">=</span> <span class="n">RSSeries</span><span class="p">(</span><span class="s1">&#39;A863&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can then access the series data using the <code>.data</code> attribute.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can find out how many items within the series are closed to public access. In this case, it should be none.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">series</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;access_status_totals&#39;</span><span class="p">][</span><span class="s1">&#39;CLOSED&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can access both the number of items described and digitised within each series. We'd expect the number described to be greater than or equal to the number digitised.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">series</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;items_described&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">series</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;items_digitised&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default, the scraper adds some extra information to the basic metadata – <code>items_digitised</code> and <code>access_status_totals</code>. To obtain these values, the scraper runs item searches – one to find digitised files, and another four to find all the access status values. This can slow things down considerably. If you want a quick response and don't care about these values, you can set <code>include_number_digitised</code> and/or <code>include_access_status</code> to <code>False</code>.</p>
<p>In the case below, the series data should <strong>not</strong> include a value for <code>items_digitised</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">series</span> <span class="o">=</span> <span class="n">RSSeries</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="n">include_number_digitised</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">assert</span> <span class="s1">&#39;items_digitised&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The extracted data is saved into a simple key-value cache to speed up repeat requests. If you want to scrape a fresh version, use <code>.refresh_cache()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSSeries.refresh_cache" class="doc_header"><code>RSSeries.refresh_cache</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L917" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSSeries.refresh_cache</code>()</p>
</blockquote>
<p>Delete data for this item from the cache, then extract a fresh version from RecordSearch.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check that this has worked by comparing the value of <code>retrieved</code>, which is the date/time the data was scraped.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">old_retrieved_date</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;retrieved&#39;</span><span class="p">]</span>

<span class="n">series</span><span class="o">.</span><span class="n">refresh_cache</span><span class="p">()</span>

<span class="n">new_retrieved_date</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;retrieved&#39;</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">old_retrieved_date</span> <span class="o">!=</span> <span class="n">new_retrieved_date</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSSeriesSearch" class="doc_header"><code>class</code> <code>RSSeriesSearch</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L970" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSSeriesSearch</code>(<strong><code>results_per_page</code></strong>=<em><code>20</code></em>, <strong><code>sort</code></strong>=<em><code>1</code></em>, <strong><code>record_detail</code></strong>=<em><code>'brief'</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/recordsearch_data_scraper/scrapers.html#RSSearch"><code>RSSearch</code></a></p>
</blockquote>
<p>Search for series in RecordSearch.</p>
<p>Supply any of the series search parameters as kwargs to initialise the search.</p>
<p>Optional parameters:</p>
<ul>
<li><code>results_per_page</code> (default: 20)</li>
<li><code>sort</code> (default: 1 – order by id)</li>
<li><code>page</code> – to retrieve a specific page of results</li>
<li><code>record_detail</code> – amount of detail to include, options are:<ul>
<li>'brief' (default) – just the info in the search results</li>
<li>'full' – get the full individual record for each result (slow)</li>
</ul>
</li>
</ul>
<p>To access a page of results, use the <code>.get_results()</code> method.
This method increments the results page, so you can call it in a loop
to retrieve the complete result set.</p>
<p>Useful attributes:</p>
<ul>
<li><code>.total_results</code> – the total number of results in the results set</li>
<li><code>.total_pages</code> – the total number of result pages</li>
<li><code>.kwargs</code> – a dict containing the supplied search parameters</li>
<li><code>.params</code> – a dict containing the values of the optional parameters</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Series-search-parameters">Series search parameters<a class="anchor-link" href="#Series-search-parameters"> </a></h3><p>These are the parameters you can supply as keyword arguments to <a href="/recordsearch_data_scraper/scrapers.html#RSSeriesSearch"><code>RSSeriesSearch</code></a>.</p>
<table>
<thead><tr>
<th style="text-align:left">Parameter</th>
<th style="text-align:left">Input type</th>
<th style="text-align:left">Values</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>kw</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Keywords or phrase to search for</td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_options</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">How to combine the keywords – see <a href="#Series-keyword-options">keyword options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_exclude</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Keywords or phrase to exclude</td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_exclude_options</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">How to combine the keywords – see <a href="#Series-keyword-options">keyword options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>search_notes</strong></td>
<td style="text-align:left">Checkbox</td>
<td style="text-align:left">Set to <code>True</code> to search notes as well as titles</td>
</tr>
<tr>
<td style="text-align:left"><strong>series_id</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Search for this series identifier</td>
</tr>
<tr>
<td style="text-align:left"><strong>date_from</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Include series with content after this date (year only) – eg '1925'</td>
</tr>
<tr>
<td style="text-align:left"><strong>date_to</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Include series with content before this date (year only) – eg '1945'</td>
</tr>
<tr>
<td style="text-align:left"><strong>formats</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to series with items in this format – see <a href="#Series-format-options">format options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>formats_exclude</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Exclude series with items in this format  – see <a href="#Series-format-options">format options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>locations</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to series held in this location – see list of <a href="#Series-location-options">locations</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>locations_exclude</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Exclude series held in this location – see list of <a href="#Series-location-options">locations</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>agency_recording</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to series created by this agency or person</td>
</tr>
<tr>
<td style="text-align:left"><strong>agency_controlling</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to series controlled by this agency or person</td>
</tr>
</tbody>
</table>
<h3 id="Series-keyword-options">Series keyword options<a class="anchor-link" href="#Series-keyword-options"> </a></h3><p>Use one of the following values to specify how keywords or phrases should be treated using the <code>kw_options</code> parameter. The default is 'ALL'.</p>
<ul>
<li><strong>'ALL'</strong> (default) – must include all keywords</li>
<li><strong>'ANY'</strong> – must include at least one of the keywords</li>
<li><strong>'EXACT'</strong> – treat the keywords as a phrase</li>
</ul>
<h3 id="Series-location-options">Series location options<a class="anchor-link" href="#Series-location-options"> </a></h3><p>Use one of the following values with the <code>locations</code> and <code>locations_exclude</code> parameters to limit your results to items held in that location. The default is to include all locations.</p>
<ul>
<li><strong>'NAT,ACT'</strong> – National office (ACT)</li>
<li><strong>'AWM'</strong> – Australian War Memorial</li>
<li><strong>'NSW'</strong></li>
<li><strong>'NT'</strong></li>
<li><strong>'QLD'</strong></li>
<li><strong>'SA'</strong></li>
<li><strong>'TAS'</strong></li>
<li><strong>'VIC'</strong></li>
<li><strong>'WA'</strong></li>
</ul>
<h3 id="Series-format-options">Series format options<a class="anchor-link" href="#Series-format-options"> </a></h3><p>Use one of the following values with the <code>formats</code> and <code>formats_exclude</code> parameters to limit your results to series containing that format. The default is to include all formats.</p>
<ul>
<li><strong>'Paper files and documents'</strong></li>
<li><strong>'Index cards'</strong></li>
<li><strong>'Bound volumes'</strong></li>
<li><strong>'Cartographic records'</strong></li>
<li><strong>'Photographs'</strong></li>
<li><strong>'Microforms'</strong></li>
<li><strong>'Audio-visual records'</strong></li>
<li><strong>'Audio records'</strong></li>
<li><strong>'Electronic records'</strong></li>
<li><strong>'3-dimensional records'</strong></li>
<li><strong>'Scientific specimens'</strong></li>
<li><strong>'Textiles'</strong></li>
</ul>
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h3><p>Initialise a search.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">series_results</span> <span class="o">=</span> <span class="n">RSSeriesSearch</span><span class="p">(</span><span class="n">agency_recording</span><span class="o">=</span><span class="s1">&#39;CA 1196&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can access the <code>.total_results</code> attribute to find out how many results there are.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">series_results</span><span class="o">.</span><span class="n">total_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Naturally enough, the <code>.total_results</code> value should be an integer, as should <code>.total_pages</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series_results</span><span class="o">.</span><span class="n">total_results</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series_results</span><span class="o">.</span><span class="n">total_pages</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">series_results</span><span class="o">.</span><span class="n">params</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSSearch.get_results" class="doc_header"><code>RSSearch.get_results</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L504" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSSearch.get_results</code>(<strong><code>page</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Return a list of results from a search results page.</p>
<p>The <code>page</code> value is incremented with each request, so you can call this method
in a loop to retrieve the complete results set. When you reach then of the results,
this method will return an empty list.</p>
<p>Optional parameter:</p>
<ul>
<li><code>page</code> – request a specific page from the results set</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">series_results</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calling <code>.refresh_cache</code> will remove all of the data for this search from the cache, and set the results page back to 1.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSSearch.refresh_cache" class="doc_header"><code>RSSearch.refresh_cache</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L553" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSSearch.refresh_cache</code>()</p>
</blockquote>
<p>Delete data for this search from the cache, then retrieve a fresh version from RecordSearch.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSAgency" class="doc_header"><code>class</code> <code>RSAgency</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L1056" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSAgency</code>(<strong><code>identifier</code></strong>=<em><code>None</code></em>, <strong><code>cache</code></strong>=<em><code>True</code></em>, <strong><code>details</code></strong>=<em><code>None</code></em>, <strong><code>include_series_count</code></strong>=<em><code>True</code></em>) :: <a href="/recordsearch_data_scraper/scrapers.html#RSEntity"><code>RSEntity</code></a></p>
</blockquote>
<p>Class used for extracting data about an individual agency.
You need to supply the following parameter:</p>
<ul>
<li><code>identifier</code> – the series number, eg 'A1', 'B2455'</li>
</ul>
<p>The series data is obtained by accessing the series' <code>.data</code> attribute.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here are the the fields returned:</p>
<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>location</code> (string)</li>
<li><code>functions</code> – a list of functions performed by this agency, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>controlling_organisation</code> – a list of organisations, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>previous_agencies</code> – a list of agencies, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>subsequent_agencies</code> – a list of agencies, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>superior_agencies</code> – a list of agencies, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>controlled_agencies</code> – a list of agencies, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>associated_people</code> (list) – a list of people, each with the fields:<ul>
<li><code>identifier</code> (string)</li>
<li><code>title</code> (string)</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
</ul>
</li>
<li><code>date_str</code> (string)</li>
<li><code>start_date</code> (ISO formatted date)</li>
<li><code>end_date</code> (ISO formatted date)</li>
<li><code>number_of_series</code> (integer) – number of series created by this agency</li>
<li><code>retrieved</code> (ISO formatted date)</li>
</ul>
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h3><p>To retrieve information about an agency, just give <a href="/recordsearch_data_scraper/scrapers.html#RSAgency"><code>RSAgency</code></a> the agency identifier.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agency</span> <span class="o">=</span> <span class="n">RSAgency</span><span class="p">(</span><span class="s1">&#39;CA 343&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can then access the agency data using the <code>.data</code> attribute.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agency</span><span class="o">.</span><span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Use <code>agency.data[FIELD NAME]</code> to access individual fields. The <code>agency_status</code> value of this agency should be 'Head Office'.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">agency</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;agency_status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Head Office&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The extracted data is saved into a simple key-value cache to speed up repeat requests. If you want to scrape a fresh version, use <code>.refresh_cache()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSEntity.refresh_cache" class="doc_header"><code>RSEntity.refresh_cache</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L385" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSEntity.refresh_cache</code>()</p>
</blockquote>
<p>Delete data for this entity from the cache, then extract a fresh version from RecordSearch.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RSAgencySearch" class="doc_header"><code>class</code> <code>RSAgencySearch</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L1120" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RSAgencySearch</code>(<strong><code>results_per_page</code></strong>=<em><code>20</code></em>, <strong><code>sort</code></strong>=<em><code>1</code></em>, <strong><code>record_detail</code></strong>=<em><code>'brief'</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/recordsearch_data_scraper/scrapers.html#RSSearch"><code>RSSearch</code></a></p>
</blockquote>
<p>Search for agencies in RecordSearch.</p>
<p>Supply any of the agency search parameters as kwargs to initialise the search.</p>
<p>Optional parameters:</p>
<ul>
<li><code>results_per_page</code> (default: 20)</li>
<li><code>sort</code> (default: 1 – order by id)</li>
<li><code>page</code> – to retrieve a specific page of results</li>
<li><code>record_detail</code> – amount of detail to include, options are:<ul>
<li>'brief' (default) – just the info in the search results</li>
<li>'full' – get the full individual record for each result (slow)</li>
</ul>
</li>
</ul>
<p>To access a page of results, use the <code>.get_results()</code> method.
This method increments the results page, so you can call it in a loop
to retrieve the complete result set.</p>
<p>Useful attributes:</p>
<ul>
<li><code>.total_results</code> – the total number of results in the results set</li>
<li><code>.total_pages</code> – the total number of result pages</li>
<li><code>.kwargs</code> – a dict containing the supplied search parameters</li>
<li><code>.params</code> – a dict containing the values of the optional parameters</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Agency-search-parameters">Agency search parameters<a class="anchor-link" href="#Agency-search-parameters"> </a></h3><p>These are the parameters you can supply as keyword arguments to <a href="/recordsearch_data_scraper/scrapers.html#RSAgencySearch"><code>RSAgencySearch</code></a>.</p>
<table>
<thead><tr>
<th style="text-align:left">Parameter</th>
<th style="text-align:left">Input type</th>
<th style="text-align:left">Values</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>kw</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Keywords or phrase to search for</td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_options</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">How to combine the keywords – see <a href="#Agency-keyword-options">keyword options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_exclude</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Keywords or phrase to exclude</td>
</tr>
<tr>
<td style="text-align:left"><strong>kw_exclude_options</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">How to combine the keywords – see <a href="#Agency-keyword-options">keyword options</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>function</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Limit to agencies that performed this function – see <a href="#Agency-function-note">note</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>date_from</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Include agencies that existed after this date (year only) – eg '1925'</td>
</tr>
<tr>
<td style="text-align:left"><strong>date_to</strong></td>
<td style="text-align:left">Text</td>
<td style="text-align:left">Include agencies that existed before this date (year only) – eg '1945'</td>
</tr>
<tr>
<td style="text-align:left"><strong>locations</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to agencies in this location – see list of <a href="#Agency-location-options">locations</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>locations_exclude</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Exclude agencies in this location – see list of <a href="#Agency-location-options">locations</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>agency_status</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Limit to agencies with this status – see <a href="#Agency-status-options">list of possible values</a></td>
</tr>
<tr>
<td style="text-align:left"><strong>agency_status_exclude</strong></td>
<td style="text-align:left">Select</td>
<td style="text-align:left">Exclude agencies with this status – see <a href="#Agency-status-options">list of possible values</a></td>
</tr>
</tbody>
</table>
<h3 id="Agency-keyword-options">Agency keyword options<a class="anchor-link" href="#Agency-keyword-options"> </a></h3><p>Use one of the following values to specify how keywords or phrases should be treated using the <code>kw_options</code> parameter. The default is 'ALL'.</p>
<ul>
<li><strong>'ALL'</strong> (default) – must include all keywords</li>
<li><strong>'ANY'</strong> – must include at least one of the keywords</li>
<li><strong>'EXACT'</strong> – treat the keywords as a phrase</li>
</ul>
<h3 id="Agency-function-note">Agency function note<a class="anchor-link" href="#Agency-function-note"> </a></h3><p>In theory, functions are a controlled, hierarchical list, but previous examinations have shown that the use of functions in RecordSearch can be inconsistent. Here's a <a href="https://github.com/GLAM-Workbench/recordsearch/blob/master/data/functions.txt">list of functions</a> extracted from the RecordSearch interface that you can use as values with the <code>function</code> parameter.</p>
<h3 id="Agency-location-options">Agency location options<a class="anchor-link" href="#Agency-location-options"> </a></h3><p>Use one of the following values with the <code>locations</code> and <code>locations_exclude</code> parameters to limit your results to agencies in that location. The default is to include all locations.</p>
<ul>
<li><strong>'NAT,ACT'</strong></li>
<li><strong>'COCOS OR CHRISTMAS ISLAND'</strong></li>
<li><strong>'NSW'</strong></li>
<li><strong>'NT'</strong></li>
<li><strong>'OVERSEAS'</strong></li>
<li><strong>'PNG'</strong> – Papua New Guinea</li>
<li><strong>'QLD'</strong></li>
<li><strong>'SA'</strong></li>
<li><strong>'TAS'</strong></li>
<li><strong>'VIC'</strong></li>
<li><strong>'WA'</strong></li>
</ul>
<h3 id="Agency-status-options">Agency status options<a class="anchor-link" href="#Agency-status-options"> </a></h3><p>Use one of the following values with the <code>agency_status</code> and <code>agency_status_exclude</code> parameters to limit your results to agencies with that status. The default is to include all status values.</p>
<ul>
<li><strong>'DOS'</strong> – Department of State</li>
<li><strong>'HO'</strong> – Head Office</li>
<li><strong>'RO'</strong> – Regional or State Office</li>
<li><strong>'INTGOV'</strong> – Intergovernmental agency</li>
<li><strong>'COURT'</strong> – Judicial Court or Tribunal</li>
<li><strong>'LO'</strong> – Local Office</li>
<li><strong>'NONEX'</strong> – Non-Executive government agency (Courts, Parliament)</li>
</ul>
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h3><p>Search for all agencies that have performed the 'SCIENCE' function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agency_search</span> <span class="o">=</span> <span class="n">RSAgencySearch</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="s1">&#39;science&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialising the <a href="/recordsearch_data_scraper/scrapers.html#RSAgencySearch"><code>RSAgencySearch</code></a> class sets up the search and retrieves some information about the results set. For example, to see the total number of results, we just access the <code>.total_results</code> attribute.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agency_search</span><span class="o">.</span><span class="n">total_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSSearch.get_results" class="doc_header"><code>RSSearch.get_results</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L504" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSSearch.get_results</code>(<strong><code>page</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Return a list of results from a search results page.</p>
<p>The <code>page</code> value is incremented with each request, so you can call this method
in a loop to retrieve the complete results set. When you reach then of the results,
this method will return an empty list.</p>
<p>Optional parameter:</p>
<ul>
<li><code>page</code> – request a specific page from the results set</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">cache_db</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">agency_search</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Calling <code>.refresh_cache</code> will remove all of the data for this search from the cache, and set the results page back to 1.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RSSearch.refresh_cache" class="doc_header"><code>RSSearch.refresh_cache</code><a href="https://github.com/wragge/recordsearch_data_scraper/tree/master/recordsearch_data_scraper/scrapers.py#L553" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RSSearch.refresh_cache</code>()</p>
</blockquote>
<p>Delete data for this search from the cache, then retrieve a fresh version from RecordSearch.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

